<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>Pinned Cross-Reveal with Real Next Panel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

    <!-- ë°ëª¨ìš© í°íŠ¸ -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@600&family=Noto+Serif+KR:wght@700&family=Playfair+Display:wght@700&family=Poppins:wght@700&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        box-sizing: border-box;
        margin: 0;
      }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans,
          sans-serif;
        background: #d6d2c4;
        color: #111;
      }
      .spacer {
        height: 80vh;
        display: grid;
        place-items: center;
      }

      /* í•€ë  ì„¹ì…˜ */
      .pin-wrap {
        height: 100vh;
        display: grid;
        place-items: center;
      }

      .inner {
        width: min(86vw, 1100px);
        height: min(88vh, 900px);
        display: grid;
        grid-template-rows: auto 1fr; /* íƒ€ì´í‹€ / ìŠ¤í…Œì´ì§€ */
        gap: clamp(12px, 2.5vh, 28px);
      }

      /* ===== íƒ€ì´í‹€(í°íŠ¸ í˜ì´ë“œ êµì²´) ===== */
      .typo {
        position: relative;
        height: clamp(60px, 16vh, 150px);
        overflow: hidden;
      }
      .title {
        position: absolute;
        inset: 0;
        display: grid;
        place-items: center;
        font-size: clamp(24px, 5.8vw, 60px);
        line-height: 1.08;
        text-align: center;
        letter-spacing: -0.02em;
        color: #1c1c1c;
        filter: drop-shadow(0 1px 0 rgba(255, 255, 255, 0.12));
        opacity: 0;
        will-change: opacity, transform;
      }
      .title.is-active {
        opacity: 1;
      }
      .font-1 {
        font-family: 'Noto Sans KR', 'Poppins', sans-serif;
      }
      .font-2 {
        font-family: 'Noto Serif KR', serif;
      }
      .font-3 {
        font-family: 'Playfair Display', serif;
      }
      .font-4 {
        font-family: 'Poppins', sans-serif;
      }

      /* ===== ìŠ¤í…Œì´ì§€: ì´ë¯¸ì§€ + ìµœì¢… ì»¨í…ì¸  íŒ¨ë„ ===== */
      .stage {
        position: relative;
        width: 100%;
        aspect-ratio: 16/9;
        overflow: hidden;
        border-radius: 14px;
        background: #000;
        box-shadow: 0 12px 36px rgba(0, 0, 0, 0.18);
      }
      .stage > * {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        will-change: transform, opacity;
        transform: translateY(0%);
      }
      .stage img {
        object-fit: cover;
        display: block;
      }

      /* ìŒ“ì´ëŠ” ìˆœì„œ(ìœ„ â†’ ì•„ë˜) */
      .stage > *:nth-child(1) {
        z-index: 5;
      } /* ë§¨ ìœ„ */
      .stage > *:nth-child(2) {
        z-index: 4;
      }
      .stage > *:nth-child(3) {
        z-index: 3;
      }
      .stage > *:nth-child(4) {
        z-index: 2;
      }
      .stage > *:nth-child(5) {
        z-index: 1;
      } /* ë§¨ ì•„ë˜(ìµœì¢… ì»¨í…ì¸  íŒ¨ë„) */

      /* ===== ë§ˆì§€ë§‰ íŒ¨ë„: ì‹¤ì œ ë‹¤ìŒ ì»¨í…ì¸ (Adaptive Living Spaces) ===== */
      .final-panel {
        background: #f7f4ea; /* ë‹¤ìŒ ì„¹ì…˜ê³¼ í†¤ì„ ë§ì¶”ë©´ ì „í™˜ì´ ë§¤ëˆí•´ì§ */
        color: #1b1b1b;
        display: grid;
        grid-template-rows: auto 1fr;
        padding: clamp(18px, 2.6vh, 28px);
        gap: clamp(12px, 2vh, 20px);
      }
      .final-panel h3 {
        font: 700 clamp(20px, 3.2vw, 36px) / 1.1 'Noto Serif KR', serif;
        margin: 0;
      }
      .final-panel p {
        margin: 0;
        font-size: clamp(14px, 1.6vw, 16px);
        line-height: 1.6;
        opacity: 0.9;
        align-self: start;
        max-width: 72ch;
      }

      /* ì‹¤ì œ ë‹¤ìŒ ì„¹ì…˜(ì—°ì†ê° ìœ ì§€) */
      .next {
        background: #f7f4ea;
        padding: clamp(28px, 6vw, 64px) 6vw;
      }
    </style>
  </head>
  <body>
    <div class="spacer"><h2>ìœ„ ì»¨í…ì¸ </h2></div>

    <section class="pin-wrap">
      <div class="inner">
        <!-- íƒ€ì´í‹€(í°íŠ¸ í˜ì´ë“œ) -->
        <div class="typo" id="typo">
          <h2 class="title font-1 is-active">World First Climate Control</h2>
          <h2 class="title font-2">World First Climate Control</h2>
          <h2 class="title font-3">World First Climate Control</h2>
          <h2 class="title font-4">World First Climate Control</h2>
        </div>

        <!-- ìŠ¤í…Œì´ì§€: ì´ë¯¸ì§€ 4ì¥ + ë§ˆì§€ë§‰ 'ì‹¤ì œ ì»¨í…ì¸ ' íŒ¨ë„ -->
        <div class="stage" id="stage">
          <img src="https://picsum.photos/id/1015/1600/900" alt="img1" />
          <img src="https://picsum.photos/id/1025/1600/900" alt="img2" />
          <img src="https://picsum.photos/id/1035/1600/900" alt="img3" />
          <img src="https://picsum.photos/id/1043/1600/900" alt="img4" />

          <!-- ğŸ‘‡ ì´ê²Œ 'Adaptive Living Spaces'ê°€ ë˜ëŠ” ìµœì¢… íŒ¨ë„ -->
          <article class="final-panel" id="finalPanel">
            <h3>Adaptive Living Spaces</h3>
            <p>
              ì‹¤ë‚´/ì‹¤ì™¸ ë°ì´í„°ë¥¼ í†µí•© ë¶„ì„í•´ ì‹œê°„ëŒ€Â·í™œë™Â·ì¬ì‹¤ ì¸ì› ë³€í™”ì— ë§ì¶°
              ì˜¨ë„Â·ìŠµë„Â·ê³µê¸° íë¦„ì„ ëŠ¥ë™ì ìœ¼ë¡œ ì¡°ìœ¨í•©ë‹ˆë‹¤. í•€ êµ¬ê°„ì´ ëë‚˜ë©´ ì´
              ì»¨í…ì¸ ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§‘ë‹ˆë‹¤.
            </p>
            <div style="align-self: end; opacity: 0.6">
              Scroll to continue â†“
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- ì‹¤ì œ ë‹¤ìŒ ì„¹ì…˜(í†¤ì„ ë§ì¶° ë§¤ë„ëŸ¬ìš´ ì—°ê²°ê°) -->
    <section class="next">
      <h2
        style="
          font: 700 clamp(26px, 4.8vw, 48px) / 1.1 'Noto Serif KR', serif;
          margin: 0 0 16px;
        "
      >
        Adaptive Living Spaces
      </h2>
      <p style="max-width: 72ch; line-height: 1.7">
        ì—¬ê¸°ë¶€í„°ëŠ” ê³ ì • í•´ì œ ì´í›„ì˜ ë³¸ë¬¸ì´ì—ìš”. ìœ„ì˜ ìµœì¢… íŒ¨ë„ê³¼ í†¤/íƒ€ì´í¬ë¥¼
        ë§ì¶° ì „í™˜ ì´ì§ˆê°ì„ ì¤„ì˜€ìŠµë‹ˆë‹¤.
      </p>
      <div style="height: 120vh"></div>
    </section>

    <script>
      gsap.registerPlugin(ScrollTrigger);

      const stage = document.getElementById('stage');
      const images = gsap.utils.toArray('#stage img'); // ì´ë¯¸ì§€ 4ì¥
      const final = document.getElementById('finalPanel'); // ë§ˆì§€ë§‰ ì‹¤ì œ ì»¨í…ì¸  íŒ¨ë„
      const titles = gsap.utils.toArray('#typo .title'); // íƒ€ì´í‹€ 4ê°œ (ì´ë¯¸ì§€ ê°œìˆ˜ì— ë§ì¶¤)

      // íŒ¨ë„ ë°°ì—´(ìœ„â†’ì•„ë˜): ì´ë¯¸ì§€ë“¤ + ë§ˆì§€ë§‰ ì»¨í…ì¸  íŒ¨ë„
      const panels = [...images, final];
      const steps = panels.length - 1; // ì „í™˜ íšŸìˆ˜
      const seg = 1; // íƒ€ì„ë¼ì¸ êµ¬ê°„ ê¸¸ì´(ì •ê·œí™”)

      // ì²« íƒ€ì´í‹€ë§Œ ë³´ì´ê²Œ
      gsap.set(titles.slice(1), { autoAlpha: 0, y: 10 });

      // ìŠ¤í¬ë¡¤ ê°ë„/ì†ë„
      const SPEED = 1.8; // ì „ì²´ ìŠ¤í¬ë¡¤ êµ¬ê°„ ë°°ìˆ˜(â†‘ ëŠë ¤ì§)
      const SCRUB = 1.4; // ìŠ¤í¬ëŸ½ ê´€ì„±

      const tl = gsap.timeline({
        defaults: { ease: 'none' },
        scrollTrigger: {
          trigger: '.pin-wrap',
          start: 'top top',
          end: '+=' + window.innerHeight * steps * SPEED,
          scrub: SCRUB,
          pin: true,
          anticipatePin: 1,
          snap: {
            snapTo: (v) => Math.round(v * steps) / steps, // ê° ë‹¨ê³„ ê²½ê³„
            duration: 0.55,
            ease: 'power1.inOut',
          },
        },
      });

      // 1) ê° ë‹¨ê³„: ìœ„ íŒ¨ë„ì„ ìœ„ë¡œ ë°€ì–´ì˜¬ë ¤ ì•„ë˜ íŒ¨ë„ì„ ë“œëŸ¬ëƒ„
      panels.forEach((panel, i) => {
        if (i === panels.length - 1) return; // ë§ˆì§€ë§‰(ìµœì¢… ì»¨í…ì¸ )ì€ ê³ ì •(ë“œëŸ¬ë‚˜ê¸°ë§Œ)
        const t = i * seg;
        tl.to(panel, { yPercent: -100, duration: seg }, t);

        // ì´ë¯¸ì§€ ë‹¨ê³„ì— ë§ì¶° íƒ€ì´í‹€ í°íŠ¸ êµì²´ (ìµœì¢… íŒ¨ë„ ë‚˜ì˜¤ê¸° ì „ê¹Œì§€ë§Œ)
        if (i < titles.length) {
          tl.to(
            titles[i],
            { autoAlpha: 0, y: -10, duration: 0.35 },
            t + 0.05
          ).to(
            titles[i + 1] ?? titles[i],
            { autoAlpha: 1, y: 0, duration: 0.45 },
            t + 0.2
          );
        }
      });

      // 2) ìµœì¢… íŒ¨ë„ì´ ë“œëŸ¬ë‚˜ëŠ” ì‹œì ì— ìƒë‹¨ íƒ€ì´í‹€ ìì²´ë¥¼ ì‚´ì§ ê°ì¶¤(ì„ íƒ)
      const lastSwapT = (panels.length - 2) * seg; // ë§ˆì§€ë§‰ ì „í™˜ ì‹œì‘ íƒ€ì„
      tl.to('#typo', { autoAlpha: 0, y: -10, duration: 0.35 }, lastSwapT + 0.2);

      // ë¦¬ì‚¬ì´ì¦ˆ ëŒ€ì‘
      addEventListener('resize', () => ScrollTrigger.refresh());
    </script>
  </body>
</html>
